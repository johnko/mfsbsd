#!/bin/sh
# Copyright (c) 2014 John Ko

/sbin/geli load > /dev/null 2> /dev/null

if [ -d /bootdir/boot/keys ]; then
	for i in /bootdir/boot/keys/* ; do
		if [ -e "/dev/label/${i##*.}" ]; then
			/sbin/geli attach -p -k $i /dev/label/${i##*.}
		fi
	done
fi

if [ -d /bootdir/boot/keys/bootpkg ]; then
	for i in /bootdir/boot/keys/bootpkg/* ; do
		if [ -e "/dev/label/${i##*.}" ]; then
			/sbin/geli attach -p -k $i /dev/label/${i##*.}
		fi
	done
fi
